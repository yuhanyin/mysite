<% provide(:title, "All my products") %>

<div class="page-header">
  <% if isAdmin %>
      <%= link_to "add new product", new_product_path, class: "pull-right btn btn-primary" %>
  <% end %>

  <% if current_user %>
    <h1>Hello, <%= current_user.name %> <small>welcome to my store!</small></h1>
  <% else %>
    <h1>Hello, Guest <small>welcome to my store! you can login or sign up</small></h1>
  <% end %>
</div>

<div class="row">
  <div class="col-lg-6">
    <div class="input-group">
      <input id="search" type="text" class="form-control" placeholder="Search for brand">
      <span class="input-group-btn">
        <script>
          function jump() {
            var val = document.getElementById('search').value;
            location.href = val === '' ? '/' : '/?search=' + val;
          }
        </script>
        <button onclick="jump()" class="btn btn-default" type="button">Go!</button>
      </span>
    </div><!-- /input-group -->
  </div><!-- /.col-lg-6 -->
</div><!-- /.row -->

<table class="table table-hover">
  <thead>
    <th>car brand</th>
    <th>year</th>
    <th>mileage</th>
    <th>price</th>
    <th></th>
    <th></th>
    <% if isAdmin %>
    <th>control</th>
    <% end %>
  </thead>
  <tbody>
    <% @products.each do |product| %>
    <tr>
      <td><%= product.name %></td>
      <td><%= product.year %></td>
      <td><%= product.mileage %></td>
      <td><%= product.price %></td>      
      <td><%= link_to "see the detail", product %></td>      
      <td><%= link_to "buy now", new_order_path(pid: product.id) %></td>      
      <% if isAdmin %>
        <td>
          <%= link_to "edit", edit_product_path(product) %>
          | <%= link_to("delete", product, method: :delete, data: { confirm: "Are you sure?" }) %>
        </td>      
      <% end %>

    </tr>
    <% end %>
  </tbody>
</table>
<%= will_paginate %>